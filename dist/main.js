(()=>{"use strict";(function(e){const t=document.getElementById("timer-hours"),o=document.getElementById("timer-minutes"),a=document.getElementById("timer-seconds");function l(e){return e<10&&(e="0"+e),e}const n=setInterval(c,1e3);function c(){const e=function(){const e=(new Date("16 may 2021").getTime()-(new Date).getTime())/1e3,t=Math.floor(e%60),o=Math.floor(e/60%60);return{timeRemaining:e,hours:Math.floor(e/60/60),seconds:t,minutes:o}}();t.textContent=l(e.hours),o.textContent=l(e.minutes),a.textContent=l(e.seconds),e.timeRemaining<=0&&(t.textContent="00",o.textContent="00",a.textContent="00",clearInterval(n))}c()})(),(()=>{const e=document.querySelector("menu");document.addEventListener("click",(t=>{const o=t.target,a=o.closest(".menu"),l=o.closest(".close-btn"),n=o.closest(".active-menu");a?e.classList.add("active-menu"):n&&!l&&"A"!==o.tagName||e.classList.remove("active-menu")}))})(),(()=>{const e=document.querySelector(".popup");let t,o;function a(e){e.style.opacity=1;let o=e.style.opacity?parseFloat(e.style.opacity):parseInt(e.style.filter)/100;t=requestAnimationFrame((function a(){t=requestAnimationFrame(a),o>=0?(o-=.03,e.style.opacity=o,e.style.filter=`alpha(opacity='${100*o}')`):o<0&&(cancelAnimationFrame(t),e.style.display="none")}))}document.getElementById("form3").style.color="white",document.addEventListener("click",(t=>{let l=t.target;l.matches(".popup-btn")?document.documentElement.clientWidth>=768?function(e){e.style.opacity=0,e.style.display="block";let t=e.style.opacity?parseFloat(e.style.opacity):parseInt(e.style.filter)/100;o=requestAnimationFrame((function a(){o=requestAnimationFrame(a),t<1?(t+=.03,e.style.opacity=t,e.style.filter=`alpha(opacity='${100*t}')`):t>=1&&cancelAnimationFrame(o)}))}(e):(e.style.opacity=1,e.style.display="block"):l.matches(".popup-close")?document.documentElement.clientWidth>=768?a(e):e.style.display="none":(l=l.closest(".popup-content"),l||(document.documentElement.clientWidth>=768?a(e):e.style.display="none"))})),document.addEventListener("click",(e=>{e.preventDefault();const t=e.target;let o;const a=()=>{let e;o=requestAnimationFrame(a),t===document.querySelectorAll('[href="#service-block"]')[1]||t===document.querySelector('[src="images/scroll.svg"]')?e=Math.ceil(document.getElementById("service-block").getBoundingClientRect().top):t===document.querySelector('[href="#portfolio"]')?e=Math.ceil(document.getElementById("portfolio").getBoundingClientRect().top):t===document.querySelector('[href="#calc"]')?e=Math.ceil(document.getElementById("calc").getBoundingClientRect().top):t===document.querySelector('[href="#command"]')?e=Math.ceil(document.getElementById("command").getBoundingClientRect().top):t===document.querySelector('[href="#connect"]')?e=Math.ceil(document.getElementById("connect").getBoundingClientRect().top):cancelAnimationFrame(o);let l=Math.ceil(.1*e);e<=10&&(l=2),console.log(`Top ${e}    Step  ${l}`),scrollBy(0,l),(l>=e||document.documentElement.clientHeight+document.documentElement.scrollTop>=document.documentElement.scrollHeight)&&cancelAnimationFrame(o)};o=requestAnimationFrame(a)}))})(),(()=>{const e=document.querySelector(".service-header"),t=e.querySelectorAll(".service-header-tab"),o=document.querySelectorAll(".service-tab"),a=e=>{o.forEach(((o,a)=>{e===a?(t[a].classList.add("active"),o.classList.remove("d-none")):(o.classList.add("d-none"),t[a].classList.remove("active"))}))};a(0),e.addEventListener("click",(e=>{let o=e.target;o=o.closest(".service-header-tab"),o&&t.forEach(((e,t)=>{e===o&&a(t)}))}))})(),(()=>{const e=document.getElementById("all-progects"),t=e.querySelectorAll(".portfolio-item"),o=[];document.querySelectorAll(".dot").forEach((e=>{e.remove()})),t.forEach(((e,t)=>{const a=document.createElement("li");a.classList=0===t?"dot-active dot":"dot",o.push(a),document.querySelector(".portfolio-dots").append(a)}));let a,l=0;const n=(e,t,o)=>{e[t].classList.remove(o)},c=(e,t,o)=>{e[t].classList.add(o)},r=()=>{n(t,l,"portfolio-item-active"),n(o,l,"dot-active"),l++,l>=t.length&&(l=0),c(t,l,"portfolio-item-active"),c(o,l,"dot-active")},s=(e=2e3)=>{a=setInterval(r,e)};e.addEventListener("click",(e=>{e.preventDefault();const a=e.target;a.matches(".portfolio-btn, .dot")&&(n(t,l,"portfolio-item-active"),n(o,l,"dot-active"),a.matches("#arrow-right")?(l++,l>=t.length&&(l=0)):a.matches("#arrow-left")?(l--,l<0&&(l=t.length-1)):a.matches(".dot")&&o.forEach(((e,t)=>{e===a&&(l=t)})),c(t,l,"portfolio-item-active"),c(o,l,"dot-active"))})),e.addEventListener("mouseover",(e=>{(e.target.matches(".portfolio-btn")||e.target.matches(".dot"))&&clearInterval(a)})),e.addEventListener("mouseout",(e=>{(e.target.matches(".portfolio-btn")||e.target.matches(".dot"))&&s()})),s()})(),document.addEventListener("mouseover",(e=>{const t=e.target;t.matches(".command__photo")&&(t.src=t.dataset.img)})),document.addEventListener("mouseout",(e=>{const t=e.target;if(t.matches(".command__photo")){let e=t.src;e=e.substring(0,e.indexOf("a.jpg"))+".jpg",t.src=e}})),document.querySelectorAll(".form-email").forEach((e=>{e.required=!0})),document.addEventListener("input",(e=>{const t=e.target;t.matches(".calc-block>input")?t.value=t.value.replace(/\D/,""):t.matches(".form-name, #form2-name")?t.value=t.value.replace(/[^ А-яа-я]/,""):t.matches("#form2-message")?t.value=t.value.replace(/[^ А-яа-я\.\,\!\:\;\-\)\(]/,""):t.matches(".form-email")?t.value=t.value.replace(/[^\w\-@\.\!~\*']/g,""):t.matches(".form-phone")&&(t.value=t.value.replace(/[^\d\+]/g,""))})),document.addEventListener("blur",(e=>{const t=e.target;if(t.matches(".calc-block>input")){const e=t.value.match(/\d/g);null!==e&&(t.value=e.join(""))}else if(t.matches(".form-name, #form2-name"))t.value=t.value.replace(/\s+/g," "),t.value=t.value.replace(/(\s\-)+/g,""),t.value=t.value.replace(/\-+/g,"-"),t.value=t.value.replace(/^[\s\-]+/gi,""),t.value=t.value.replace(/\w+/gi,""),t.value=t.value.replace(/\-$/gi,""),t.value&&(t.value=t.value.split(/\s+/).map((e=>e[0].toUpperCase()+e.substring(1).toLowerCase())).join(" "));else if(t.matches(".form-email")){let e=t.value.match(/@/);e||""===t.value?(e=t.value.match(/[\w\.]{1,10}@[a-z1-9]{2,10}\.[a-z]{2,3}/gi),e||""===t.value||(alert("Неверно указан домен"),t.value="")):(alert("E-mail должен содержать символ @"),t.value="")}else t.matches(".form-phone")?(t.value=t.value.replace(/^8{1}|^7|\+7/gi,"+7 "),t.value=t.value.replace(/^...([0-9]{3})/g,((e,t)=>`+7 ${t} `)),14!==t.value.length&&""!==t.value&&(t.value="",alert("Проверьте номер"))):t.matches("#form2-message")&&(t.value=t.value.replace(/\s+/g," "),t.value=t.value.replace(/\-+/g,"-"),t.value=t.value.replace(/^[\s\-]+/gi,""),t.value=t.value.replace(/\w+/gi,""),t.value=t.value.replace(/([а-я]{1})/i,((e,t)=>t.toUpperCase())))}),!0),((e=100)=>{const t=document.querySelector(".calc-type"),o=document.querySelector(".calc-square"),a=document.querySelector(".calc-count"),l=document.querySelector(".calc-day"),n=document.getElementById("total");document.querySelector(".calc-block").addEventListener("change",(c=>{const r=c.target;(r.matches("select")||r.matches("input"))&&(()=>{let c=0,r=1,s=1;const i=t.options[t.selectedIndex].value,m=+o.value;let u;a.value>1&&a.value&&(r+=(a.value-1)/10),s=l.value<5&&l.value?2:l.value<10&&l.value?1.5:1,i&&m&&(c=Math.ceil(e*i*m*r*s)),u=requestAnimationFrame((function e(){let t=parseInt(n.textContent);u=requestAnimationFrame(e),t<c?(t+=Math.ceil(.05*(c-t)),n.textContent=t):t>c?(t-=Math.ceil(.05*(t-c)),n.textContent=t):(n.textContent=c,cancelAnimationFrame(u))}))})()}))})(100),(()=>{const e=document.querySelectorAll('[name="user_form"]'),t=document.createElement("div"),o=document.createElement("div");let a;t.appendChild(o),t.style.cssText="font-size: 2rem",e.forEach((e=>{e.addEventListener("submit",(l=>{l.preventDefault(),e.appendChild(t),o.textContent="",t.classList.add("lds-circle");const n=new FormData(e),c={};if(n.forEach(((e,t)=>{c[t]=e})),!c.user_email)throw document.querySelectorAll("input").forEach((e=>{e.value=""})),t.classList.remove("lds-circle"),o.textContent="Не заполнено обязательное поле E-Mail",setTimeout((()=>o.textContent=""),3e3),new Error("email is empty");(e=>fetch("./server.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}))(c).then((l=>{if(200!==l.status)throw new Error("Network status is not 200");t.classList.remove("lds-circle"),o.textContent="Спасибо, мы скоро с Вами свяжемся",setTimeout((()=>o.textContent=""),3e3),document.querySelectorAll("input").forEach((e=>{e.value=""})),e.matches("#form3")&&setTimeout((()=>{document.documentElement.clientWidth>=768?function(e){e.style.opacity=1;let t=e.style.opacity?parseFloat(e.style.opacity):parseInt(e.style.filter)/100;a=requestAnimationFrame((function o(){a=requestAnimationFrame(o),t>=0?(t-=.03,e.style.opacity=t,e.style.filter=`alpha(opacity='${100*t}')`):t<0&&(cancelAnimationFrame(a),e.style.display="none")}))}(document.querySelector(".popup")):document.querySelector(".popup").style.display="none"}),2e3)})).catch((e=>{t.classList.remove("lds-circle"),o.textContent="Что-то пошло не так",setTimeout((()=>o.textContent=""),3e3),console.error(e)}))}))}))})()})();